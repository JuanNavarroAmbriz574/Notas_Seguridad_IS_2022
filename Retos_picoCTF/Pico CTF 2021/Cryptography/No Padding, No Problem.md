## Objetivo
Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with `nc mercury.picoctf.net 28517`.

## Solución
1. Nos conectamos a `nc mercury.picoctf.net 28517`
``` bash
┌──(kali㉿kali)-[~/pico]
└─$ nc mercury.picoctf.net 28517 
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 79580437252587286744169257718423808700059263387129923796931059675855682096716300078228996853594272843888726016981954257732039482841946799509764456913347632534776737601982235466421711237610359833792767717100628192273998576877249729300934873592723867203482579736877219977894218676635308292168273927257705635909
e: 65537
ciphertext: 12878419717460376853676710808953780144628554137684601722837676267713106432332338955875593076370625173923020698257436074839475515113904743123785195923636091905508748070646429305372658935408652562833096062353743342811903531887767161528836623556344032849858316072852992049106142745636740742934898008622451345993


Give me ciphertext to decrypt: 1809808921752652213841056482490081879816661403249718658593201165225621768466295695165590040338665210826399691769854338909729565533813940100084737946777937801485037145791356776266693760540201611822616088828576339448698122378153239364191909633253424765086714425483082059463617939461453083364839745173807628720786191692925377647427947397988596376839759372137506405044005227804619310445701364975051060699055134191501209314127287537637236461825523265592356117407936413922523322581802792575330881281850338742160559554394110166961638990047146294281669141843247946591903702871232399406412251248504426827600155598389888564500
Here you go: 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769281669222390720762
Give me ciphertext to decrypt:                                                                                                                                                                        


```


``` python
┌──(kali㉿kali)-[~]
└─$ python

Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from Crypto.Util.number import long_to_bytes
>>> from Crypto.Util.number import inverse
>>> 
>>> n = 89581460230915558347546233143602677148843469864283766992468831692523643064411102078685936094032794893052263131320088689442315756322607359972630871568696799122877774174587083165410589204577877453739852408809621126059975909345994406902898885079847017505887387218202736848906723441304151077379560723555592744121
>>> e = 65537
>>> c = 30432354148925298491714722227531712407187629835850578049892015242602324416464822290208982499723948775662030318570100655745703549408692687766031948089886660358886224733495943459337210011747382133977563170426608844926779166560217006730983300745114156958816670332964653753168686791827843555050959796872132204951
>>> 
>>> 
>>> x = pow(2,e,n)
>>> c = c * x
>>> c
1809808921752652213841056482490081879816661403249718658593201165225621768466295695165590040338665210826399691769854338909729565533813940100084737946777937801485037145791356776266693760540201611822616088828576339448698122378153239364191909633253424765086714425483082059463617939461453083364839745173807628720786191692925377647427947397988596376839759372137506405044005227804619310445701364975051060699055134191501209314127287537637236461825523265592356117407936413922523322581802792575330881281850338742160559554394110166961638990047146294281669141843247946591903702871232399406412251248504426827600155598389888564500
>>> m ) 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769281669222390720762 // 2
  File "<stdin>", line 1
    m ) 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769281669222390720762 // 2
      ^
SyntaxError: unmatched ')'
>>> m = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769281669222390720762 // 2
>>> long_to_bytes(m)
b'picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_4005534}'

```
## Notas
En RSA un encriptado sin padding se convierte en un encriptado homomorfico lo que significa:
Encriptar(m1) x Encriptar(m2) = Encriptar(m1 x m2) donde m1 y m2 se refiere a textos planos.