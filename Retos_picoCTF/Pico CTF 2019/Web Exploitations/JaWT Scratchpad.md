## Objetivo
Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/63090/` or http://jupiter.challenges.picoctf.org:63090

## Solución
1. Entrar al sitio y registrarse con cualquier nombre.
2. Revisa las cookies del sitio. Al registrarte el sitio debio crear una cookie llamada jwt.
5. Guarda el valor de la cookie generada dentro de tu maquina.
``` bash
$ echo "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoianVhbiJ9.I29J-YNj3Y_yDQhKzE7tpQNKiQSRGGt0FghGyJpN3ns" > hash 
```
4. Como vamos a utilizar un ataque de diccionario para obtner el hash correcto tenemos que tener un lista de las contraseñas más usadas a lo largo del mundo; esta lista se llama rockyou. Si tienes kali linux esta lista de palabras ya viene descargada y se encunetra en /usr/share/wordlists/
5. Instalamos la herramienta de hacking jhon the ripper.
``` bash
$ sudo apt install john
```

6. Usamos para adivinar la contraseña.
``` bash
john hash -w /usr/share/wordlists/rockyou.txt
```
7. Al correr el comando anterior esto nos dira que la contraseña usada fue ilovepico
8. Nos dirigimos al sitio de https://jwt.io/ y decodeamos nuestro token

![[IMG21.png]](https://github.com/JuanNavarroAmbriz574/Notas_Seguridad_IS_2022/blob/main/Retos_picoCTF/Img%20resources/IMG21.png)
Nos debe aparecer algo asi.

9. En la parte de payload establecemos un nuevo valor apara la llave user la cambiamos a admin y en la parte de firma digital ponemos ilovepico obteniendo un nuevo token.
![[IMG23.png]](https://github.com/JuanNavarroAmbriz574/Notas_Seguridad_IS_2022/blob/main/Retos_picoCTF/Img%20resources/IMG23.png)
11. Sustituimos el valor antiguo de la cookie jwt por el obtenido en el sitio https://jwt.io y lo guardamos.
12. Recargamos la página y obtnemos la bandera.
![[IMG22.png]](https://github.com/JuanNavarroAmbriz574/Notas_Seguridad_IS_2022/blob/main/Retos_picoCTF/Img%20resources/IMG22.png)
## Notas
JTW (JSON Web Token) es una forma segura de compartir información entre 2 partes mediante JSON. Esto se puede lograr gracias a las firmas digitales JWT se usa principamente para autenticación e intercambio de información.
JWT tiene la siguiente estructura
-   Header
-   Payload
-   Signature

jhon the ripper es una herramienta de hacking que sirve para el hackeo de contraseñas.
